## 빈 스코프

- 빈이 존재할 수 있는 범위

### 스프링이 지원하는 다양한 스코프

- 싱글톤 : 기본 스코프, 스프링 컨테이너의 시작과 종료까지 유지되는 가장 넓은 범위의 스코프
- 프로토타입 : 스프링 컨테이너가 프로토타입 빈의 생성과 의존관계 주입까지만 관여
- 웹 관련 스코프
  - request : 웹 요청이 들어오고 나갈때 까지 유지
  - session : 웹 세션이 생성되고 종료될 떄 까지 유지
  - application : 웹의 서블릿 컨텍스와 같은 범위로 유지

### 프로토타입 빈

- 스프링 컨테이너는 프로토타입 빈을 생성, 의존관계 주입, 초기화까지만 처리
- 프로토타입 빈의 관리 책임은 프로토타입 빈을 받은 클라이언트에 있음
- 스프링 컨테이너가 관리하지 않기에 스프링 컨테이너가 종료될 시 @PreDestroy 같은 종료 메서드가 실행되지 않음
- 클라이언트가 직접 종료해줘야함

### 싱글톤과 프로토타입 함께 사용시

- 싱글톤 빈 내부에 가지고 있는 프로토타입 빈은 이미 과거에 주입이 끝난 빈
- 스프링은 일반적으로 싱글톤 빈을 사용하므로, 싱글톤 빈이 프로토타입 빈을 사용하게 됨
- 싱글톤 빈은 생성 시점에만 의존관계 주입을 받기 때문에 프로토타입 빈이 생성은 되나 싱글톤 빈과 계속 유지됨
- 참고 : 여러 빈에서 같은 프로토타입 빈을 주입 받을 시 주입받는 시점에 각각 새로운 프로토타입 빈이 생성됨

### Provider

- Dependency Lookup (DL) : 필요한 의존관계를 직접 찾는 것
- ObjectProvider<> : 스프링 컨테이너에서 지정한 빈을 찾아서 제공. 스프링에 의존
- ObjectFactory<> : 여기에 편의 기능이 추가된게 ObjectProvider<>. 스프링에 의존
- provider 를 통해 지정한 빈을 찾아서 반환
- DL 정도의 기능만 제공

### JSR-330 Provider

- javax.inject.Provider 라는 JSR-330 자바 표준을 사용
- javax.inject:javax.inject:1 라이브러리 추가 필요
- provider 의 get() 을 통해 지정한 빈을 찾아서 반환 
- 기능이 단순, 라이브러리 필요
- 자바표준이므로 다른 컨테이너에서 사용가능

### 프로토타입 빈을 언제 사용하는가?

- 매번 사용할 때마다 의존관계 주입이 완료된 새로운 객체가 필요시 사용
- 사실상 거의 안씀 . 싱글톤으로 대부분 해결됨